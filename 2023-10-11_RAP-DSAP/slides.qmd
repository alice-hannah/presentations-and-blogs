---
title: "<img class='image1' src='images/rap_hex.png' alt=''/>Reproducible Analytical Pipelines"
author: "Alice Byers"
institute: "Data Innovation Team, Scottish Government"
date: "11 October 2023"
format:
  revealjs: 
    embed-resources: true
    slide-number: true
    preview-links: auto
    logo: images/SG-logo.jpg
    controls: true
    theme: [default, styles.scss]
lang: en
---

## Is RAP relevent to me?

-   Would it be a nightmare to have to go back and rerun your process from the beginning if you found a mistake?

-   Do you have to make a lot of manual edits to code before each run?

-   Is there a lot of repetition in your code?

-   Would a new person find it difficult to understand the process?


::: notes
-   If the answer to any of these is yes, then RAP could help you.
:::


## What is RAP?

Automated statistical and analytical processes that are:

-   Reproducible

-   Auditable

-   Efficient

-   High quality

::: footer
Source: [Reproducible Analytical Pipelines (RAP) – Government Analysis Function](https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/)
:::

::: notes
-   Reproducible means that a process can be repeated at some point in the future and will produce the same result.

-   Auditable means that it is clear who, when and why decisions have been made.

-   Efficient means that a process is as simple as possible, with no redundant steps.

-   High quality means that you are confident your process is doing what you expect it to, often demonstrated by peer review.

-   More information on these principles can be found in the [Duck book](https://best-practice-and-impact.github.io/qa-of-code-guidance/principles.html)
:::


## Features of RAP {.smaller}

In order to achieve these benefits, at a minimum a RAP must:

-   Minimise manual steps

-   Be built using open-source software; e.g. R, python

-   Be peer reviewed by colleagues

-   Be version controlled; e.g. git

-   Be open to anyone; e.g. code published on GitHub

-   Follow good practice for quality assurance

-   Contain well-commented code and have documentation embedded

::: footer
Source: [Reproducible Analytical Pipelines (RAP) – Government Analysis Function](https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/)
:::

::: notes
-   Something about how you might not apply all of these features at once / from the beginning. They all bring their own benefits, but it is a useful list to keep in mind for further developments.
:::


## RAP Strategy {.smaller}

-   Developed by Government Analysis Function to help analysts and analyst leaders understand why RAP is important and how to deliver it.

-   Vision: RAP is the default approach to analysis

-   Three goals

    -   Tools

    -   Capability

    -   Culture
    
- [Scottish Government RAP Strategy Implementation Plan 2023](https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/departmental-rap-plans/initial-scottish-government-rap-strategy-implementation-plan-2023/)

::: footer
Source: [Reproducible Analytical Pipelines (RAP) strategy – Government Analysis Function](https://analysisfunction.civilservice.gov.uk/policy-store/reproducible-analytical-pipelines-strategy/)
:::

::: notes
-   Applicable to Civil Service but content could also be useful to other public sector bodies looking to develop their RAP capability
:::


## Case Study - Existing Process

-   School Information Dashboards

-   10 data sources

-   Data cleaned, linked and analysed manually in Excel

-   Dashboards created in Tableau

-   Updated twice a year; each update took three weeks of work for three statisticians - longer if errors were found

::: footer
Blog: [How we saved 3 analysts 6 weeks of copying and pasting](https://blogs.gov.scot/statistics/2023/07/24/reproducible-analytical-pipelines-how-we-saved-3-analysts-6-weeks-of-copying-and-pasting/)
:::

::: notes
-   Case study on existing analytical process 'transformed' to RAP

-   Could also develop RAP from scratch for new process but this example illustrates the improvements and benefits compared to 'non-RAP' process well
:::


## Case Study - Planning

-   Engage with SG RAP support team

-   Define aims -- what will success look like?

-   Mock ups of what dashboards would look like

-   Planning how best to structure datasets

-   Work with data providers to improve process

::: footer
Blog: [How we saved 3 analysts 6 weeks of copying and pasting](https://blogs.gov.scot/statistics/2023/07/24/reproducible-analytical-pipelines-how-we-saved-3-analysts-6-weeks-of-copying-and-pasting/)
:::


## Case Study - RAP Principles Applied {.smaller}

<br>

:::: {.columns}

::: {.column width="22%"}
<center>
<img class='icon' alt='' src='images/folder-open-solid.svg'/>
Organised folder structure

<br>

<img class='icon' alt='' src='images/pencil-solid.svg'/>
Writing manual processes as code
</center>
:::

::: {.column width="4%"}
<!-- empty column to create gap -->
:::

::: {.column width="22%"}
<center>
<img class='icon' alt='' src='images/file-signature-solid.svg'/>
Standardised naming conventions

<br>

<img class='icon' alt='' src='images/gears-solid.svg'/>
Functions
</center>
:::

::: {.column width="4%"}
<!-- empty column to create gap -->
:::

::: {.column width="22%"}
<center>
<img class='icon' alt='' src='images/Rlogo.svg'/>
Open-source software

<br><br>

<img class='icon' alt='' src='images/git.svg'/>
Version control using git
</center>
:::

::: {.column width="4%"}
<!-- empty column to create gap -->
:::

::: {.column width="22%"}
<center>
<img class='icon' alt='' src='images/folder-tree-solid.svg'/>
Relative file paths

<br><br>

<img class='icon' alt='' src='images/github.svg'/>
Open code on GitHub
</center>
:::

::::

::: footer
Blog: [How we saved 3 analysts 6 weeks of copying and pasting](https://blogs.gov.scot/statistics/2023/07/24/reproducible-analytical-pipelines-how-we-saved-3-analysts-6-weeks-of-copying-and-pasting/)
:::

::: notes
-   Talk about how these match to 3 principles and 7 features?
:::


## Case Study - Result

-   Faster

    -   Previously took three weeks for three statisticians (twice per year)

    -   Now takes at most half a day for one statistician (twice per year)

-   More accurate

-   Reduced risk

-   Well documented

-   Developed skills to apply to other projects

::: footer
Blog: [How we saved 3 analysts 6 weeks of copying and pasting](https://blogs.gov.scot/statistics/2023/07/24/reproducible-analytical-pipelines-how-we-saved-3-analysts-6-weeks-of-copying-and-pasting/)
:::


## Where to start

-   Would it be a nightmare to have to go back and rerun your process from the beginning if you found a mistake?

    ::: {.fragment}
    - Git 
    :::

-   Do you have to make a lot of manual edits to code before each run?

    ::: {.fragment}
    - Setup script 
    :::


## Where to start

-   Is there a lot of repetition in your code?

    ::: {.fragment}
    - Functions 
    :::

-   Would a new person find it difficult to understand the process?

    ::: {.fragment}
    - Documentation 
    :::
    

::: notes
-   Think of one way you could improve your current process and try and implement a change or some changes to address this.

-   Open source: go on some training; try and replicate a small part of existing process in R (for example) to practice and test approach

-   Reproducibility: using Git keeps your history so you can revert back to previous versions if need be

-   Manual edits: set up script

-   Functions: where identical or similar code is repeated, write a function

-   Documentation: save in the same place as the project code/files; ask other people to read and give feedback; comment code
:::


## Links

-   [Government Analysis Function RAP Resources](https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/)

- [Duck book](https://best-practice-and-impact.github.io/qa-of-code-guidance/intro.html)

-   [Civil Service RAP Strategy](https://analysisfunction.civilservice.gov.uk/policy-store/reproducible-analytical-pipelines-strategy/)

-   [Blog: How we saved 3 analysts 6 weeks of copying and pasting](https://blogs.gov.scot/statistics/2023/07/24/reproducible-analytical-pipelines-how-we-saved-3-analysts-6-weeks-of-copying-and-pasting/)

-   [School Information Dashboard GitHub repository](https://github.com/DataScienceScotland/school-information-dashboard)

-   Email me -- I'm always happy to talk about RAP!

    -   [alice.byers\@gov.scot](mailto:alice.byers@gov.scot)

::: notes
-   Duck book is for 'Quality assurance of code for analysis and research'. Acronym sounds a bit like 'quack' which is the noise a duck makes.
:::